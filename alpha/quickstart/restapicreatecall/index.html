<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="imagetoolbar" content="false">
<meta name="MSSmartTagsPreventParsing" content="true">
<title></title>
<link href="../../../css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="../../../css/bluevia_style.css" rel="stylesheet" media="screen">
</head>
<body class="api" data-spy="scroll" data-target=".sidemenu">
  <script src="http://code.jquery.com/jquery-latest.js"></script><script src="../../../js/bootstrap.min.js"></script><div id="header-wrapper" class="page-header">
    <div id="header" class="container-fluid">
      <div class="row-fluid">
        <a class="logo offset1" href="../../../">
          <img src="http://bluevia.com/img/BlueVia-Hdr-Logo-SML.png" width="100" alt="Bluevia Logo"><span class="lightblue"></span>
        </a>

      </div>
    </div>
    <!-- #header --> </div>
  <!-- #header-wrapper -->

  <div class="container-fluid">
    <div class="row-fluid">
      <div class="content span8 offset1">

        <ul class="breadcrumb">
<li>
<a href="../../../">Home</a> <span class="divider">/</span>
</li>
          <li class="active">
        </ul>
<h1 id="bluevia-voice-restful-api-quick-start-guide">BlueVia Voice RESTful API Quick Start Guide</h1>

<p>For further details about the RESTful API see <a href="../../restref/">the BlueVia RESTful API reference</a>. </p>

<p>The following PHP examples will show you the basics. Again if PHP is not your bag then modify the code as needed! :-)</p>

<h2 id="creating-a-call-using-the-bluevia-voice-restful-api">Creating a Call Using The BlueVia Voice RESTful API</h2>

<p>This quick start guide mimics the <a href="../connectcallnocode/">the connect a call without any code</a> quick start guide. The difference is that in this case, instead of dialing your BlueVia Voice Number to start a call, you will instead use the API to instantiate a call. </p>

<p>So configure your BlueVia Voice Number in the <a href="https://nv.bluevia.com/en/communication/your-purchased-numbers">BlueVia Dashboard</a> to point to same JSON (or XML if you have used XML) that you used in the <a href="../connectcallnocode/">the connect a call without any code</a> quick start guide. As a reminder, this was the JSON you used</p>

<pre><code>{
    "commands": [
	{
	  "dial": {
		"number": {
		    "callerId": "tel:+442012345678",
		    "destination": "tel:+44712345678"
		}
	    }
	}
    ]
}
</code></pre>

<p><strong>Remember:</strong></p>

<ul>
<li>
<em>callerId</em> must be a BlueVia Number that you own</li>
  <li>
<em>destination</em> is the B number that you will call. 
In this example the A number will be the number you use to start a call using the API.</li>
</ul>
<p>Once you have configured your number’s callback URL to point to this JSON file, BlueVia will make a HTTP POST request to retrieve these commands, once Phone A, that you will call via an API call, answers. When Phone A answers, This JSON will result in Phone B being called and when Phone B answers, both Phone A and Phone B will be on the same call.</p>

<p>The simplest way to create a call via the RESTful API is <em>curl</em> from the command line</p>

<pre><code>curl -k -H "Accept: application/json" -H "Content-type: application/json" --user &lt;your API key&gt;:&lt;your API secret&gt; -X POST -d '{"callerId":"tel:+&lt;country code&gt;&lt;your BlueVia Voice Number&gt;","destination":"tel:+&lt;country code&gt;&lt;the number you wish to call&gt;"}' https://live-api-nv.bluevia.com:10443/comms/v1/calls 
</code></pre>

<p>When the destination phone rings, and answers the destination phone, specified in the <em>dial</em> command in the JSON referred to by the callback URL, will be called and the two phones will be connected on a call.  </p>

<p>The same of course can be managed through php and this demo uses the <em>makeACall.php</em> script that you can find in the Quick Start demo code from github  <strong>@todo: ADD LINK</strong>. </p>

<p>Stepping through <em>makeACall.php</em></p>

<pre><code>&lt;?php
$url = "https://live-api-nv.bluevia.com:10443/comms/v1/calls";
$accessCredentials = "&lt;your API key&gt;" . ":" . "&lt;your secret&gt;";
$headers = array(
    'Content-Type: application/json',
    'Accept: application/json'
    );
</code></pre>

<p>The above are simply variables used in the script:</p>

<ul>
<li>
<em>https://live-api-nv.bluevia.com:10443/comms/v1/calls</em> is the URL for the calls resource. You will make a POST request to this in order to create a call leg.</li>
  <li>
<em>$accessCredentials = ‘your API key’ . ‘:’ . ‘your secret’;</em> Here you have to add your API key and secret. These can be found on the <a href="https://nv.bluevia.com/en/communication/your-purchased-numbers">BlueVia Dashboard</a>
</li>
  <li>As you are providing a JSON body in our request and require a JSON response you have to set the appropriate <em>Content-Type</em> and <em>Accept</em> headers in your POST request</li>
</ul>
<p>Then you have to specify the body of the HTTP request to POST to the <a href="../../restref/calls/">Calls Resource</a></p>

<pre><code>// Create the First Call Leg i.e. add Phone A to the call
// this is the body content passed in with the API request
$bodyContent = "{\"callerId\":\"tel:+&lt;your BlueVia Phone Number\",\"destination\":\"tel:+&lt;Phone A Number&gt;\"}";
</code></pre>

<p>In this case, as with the <a href="../connectcallnocode/">the connect a call without any code</a> quick start guide:</p>

<ul>
<li>The callerId telephone number MUST be one of the BlueVia Voice Numbers. You can find a number to use by accessing your <a href="https://nv.bluevia.com/en/communication/your-purchased-numbers">BlueVia Dashboard</a>.</li>
  <li>The Number format is always in international dialing format *tel:+<country code=""><bluevia voice="" number="">*. 
</bluevia></country><ul>
<li>Remember to include the <em>tel:+</em> prefix</li>
    </ul>
</li>
  <li>the destination is the Phone A phone number. This is the first number you will add to the call</li>
</ul>
<p>Then you can use <a href="http://php.net/manual/en/book.curl.php">PHP cURL</a> to format your HTTP POST request to the <a href="../../restref/calls/">Calls Resource</a>.  </p>

<pre><code>// PHP stuff for making the RESTful API request
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_USERPWD, $accessCredentials);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $bodyContent);
// return the transfer as a string
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// turn off SSL cert validation
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
// get header detail
curl_setopt($ch, CURLOPT_HEADER, 1);

// $output contains the HTTP Response to the POST request
$output = curl_exec($ch);
</code></pre>

<p>Calling <em>curl_exec($ch)</em> executes the HTTP POST request to the BlueVia Voice API. </p>

<p>At this stage your Phone A will start ringing:</p>

<p>When you answer the phone, BlueVia will make a HTTP POST request to your BlueVia Voice NumberÆs callback URL (configured previously) </p>

<p>The commands set in the response, the dial command discussed above, will be executed and Phone B will start ringing.</p>

<p>Once you answer phone B, you will have a connected call between two phones. Chat away! ;-)</p>

<p>The following code, in the <em>makeACall.php</em> script is not actually used in this demo, however if you would like to modify the created call you need to have access to the call ID that is contained in the HTTP Response returned from the POST request to the <em>/calls</em> resource</p>

<pre><code>// get the HTTP response body body
$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);
$header = substr($output, 0, $header_size);
$body = substr($output, $header_size);


// Retrieve the call ID created for this call resource.
// Not required for the demo, but shows how you can access it.
$obj = json_decode($body);
$callId = $obj-&gt;{'callId'};

// close curl resource to free up system resources
curl_close($ch);
?&gt;
</code></pre>

<p>The above code retrieves the <em>callID</em>. We will use this to <a href="../modifycall/">modify an existing call with the REST API</a>.</p>

<p>To execute <em>makeACall.php</em> host the script on your Web Server, with PHP running and from the command line call <em>php makeACall.php</em> </p>

<!-- Bluevia  -->

<!-- Overview -->

<!-- Quick start -->

<!-- Restref -->

<!-- Command ref -->

<!-- Notifications -->

<!-- Error codes  -->

<!-- Roadmap -->

<!-- Play -->

<!-- Known Issues -->

        <hr>
<span id="prevPage" class="bottomLinks pull-left"></span>
        <span id="nextPage" class="bottomLinks pull-right"></span>

      </div>

      <div id="sidebar" class="span3">
        <div class="accordion" id="accordionMenu">
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionOverview" href="#collapseOverview"><i class="icon-chevron-down"></i></a><a href="../../overview/">Overview</a>
            </div>
          <div id="collapseOverview" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="js-guides nav nav-list sidemenu">
<li>
                  <a href="../../overview/restapi/">BlueVia Voice RESTful API</a>
                </li>
                <li>
                  <a href="../../overview/callcontrol/">BlueVia Voice Call Control Commands</a>
                </li>
                <li>
                  <a href="../../overview/callflows/">Call Flows</a>
                </li>
                <li>
                  <a href="../../overview/existing/">Existing BlueVia APIs and the BlueVia Voice API</a>
                </li>
                <li>
                  <a href="../../overview/balance/">Adding Balance To Your BlueVia Account</a>
                </li>
                <li>
                  <a href="../../overview/numbers/">Buying Numbers</a>
                </li>
                <li>
                  <a href="../../overview/configure/">Configuring Your BlueVia Numbers</a>
                </li>
                <li>
                  <a href="../../overview/usingnumbers/">Using Your BlueVia Voice Numbers</a>
                </li>
                <li>
                  <a href="../../overview/pricing/">BlueVia Voice API Costs</a>
                </li>
                <li>
                  <a href="../../overview/knownlimitations/">Known Alpha Limitations</a>
                </li>
              </ul>
</div>
          </div>

          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionQuickstart" href="#collapseQuickstart"><i class="icon-chevron-down"></i></a><a href="../">Quick Start Guides</a>
            </div>
          <div id="collapseQuickstart" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../connectcallnocode/">Connect a Call Without Code</a>
                </li>
                <li>
                  <a href="../createconfnocode/">Create a Conference Without Code</a>
                </li>
                <li>
                  <a href="../confwithpincode/">A Conference With Pin Code</a>
                </li>
                <li>
                  <a href="./">Create A Call With the REST API</a>
                </li>
                <li>
                  <a href="../modifycall/">Modify An Existing Call</a>
                </li>
                <li>
                  <a href="../restapicreateconf/">Create A Conference Call With The REST API</a>
                </li>
                <li>
                  <a href="../restapiupdateconfig/">Update Your Number's Config With The REST API</a>
                </li>

              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionRestRef" href="#collapseRestRef"><i class="icon-chevron-down"></i></a><a href="../../restref/">RESTful API Reference</a>
            </div>
          <div id="collapseRestRef" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../restref/request/">HTTP Request</a>
                </li>

                <li>
                  <a href="../../restref/resources/">Resources</a>
                  </li>
<li>
                    <ul class="nav nav-list">
<li>
                        <a href="../../restref/accountresources/">Account Management Resources</a>
                      </li>
                      <li>
                        <ul class="nav nav-list">
<li>
                            <a href="../../restref/account/">Account</a>
                          </li>
                          <li>
                            <a href="../../restref/accountnumber/">Account Number</a>
                          </li>
                          <li>
                            <a href="../../restref/accountconfigrulescollection/">Account Config Rules Collection</a>
                          </li>
                        </ul>
</li>
                      <li>
                        <a href="../../restref/availablenumberscollection/">Available Numbers Collection</a>
                      </li>
                      <li>
                        <a href="../../restref/calls/">Calls Resources</a>
                      </li>
                      <li>
                          <ul class="nav nav-list">
<li>
                              <a href="../../restref/callcollection/">Call Collection</a>
                            </li>
                            <li>
                              <a href="../../restref/call/">Call</a>
                            </li>
                            <li>
                              <a href="../../restref/calllegscollection/">Calls Leg Collection</a>
                            </li>
                            <li>
                              <a href="../../restref/callleg/">Call Leg</a>
                            </li>
                            <li>
                              <a href="../../restref/modifycall/">Modify Call - Set Commands</a>
                            </li>
                          </ul>
</li>
                      <li>
                        <a href="../../restref/sms/">SMS Resources</a>
                      </li>
                    </ul>
</li>
                

                <li>
                  <a href="../../restref/callstatuses/">Call Statuses</a>
                </li>
                <li>
                  <a href="../../restref/calllegstatuses/">Call Leg Statuses</a>
                </li>
              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionCommandRef" href="#collapseCommandRef"><i class="icon-chevron-down"></i></a><a href="../../commandref/">Call Control Commands Reference</a>
            </div>
          <div id="collapseCommandRef" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../commandref/sendingcallcommands/">Providing Call Commands</a>
                </li>
                <li>
                  <a href="../../commandref/dial/">Dial</a>
                </li>
                <li>
                  <ul class="nav nav-list">
<li>
                      <a href="../../commandref/dialnumber/">Dial Number</a>
                    </li>
                    <li>
                      <a href="../../commandref/dialconference/">Dial Conference</a>
                    </li>
                    <li>
                      <a href="../../commandref/dialcallid/">Dial Call Id</a>
                    </li>
                  </ul>
</li>
                <li>
                  <a href="../../commandref/speak/">Speak</a>
                </li>
                <li>
                  <a href="../../commandref/play/">Play</a>
                </li>
                <li>
                  <a href="../../commandref/getdigits/">GetDigits</a>
                </li>
                <li>
                  <a href="../../commandref/hangup/">HangUp</a>
                </li>
                <li>
                  <a href="../../commandref/redirect/">Redirect</a>
                </li>
                <li>
                  <a href="../../commandref/wait/">Wait</a>
                </li>
                <li>
                  <a href="../../commandref/sms/">SMS</a>
                </li>
                <li>
                  <a href="../../commandref/commandchains/">Command Chains</a>
                </li>
              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionNotifications" href="#collapseNotifications"><i class="icon-chevron-down"></i></a><a href="../../notifications/">Notification Events Reference</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionErrorCodes" href="#collapseErrorCodes"><i class="icon-chevron-down"></i></a><a href="../../errorcodes/">Voice and SMS Error Codes</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionRoadmap" href="#collapseRoadmap"><i class="icon-chevron-down"></i></a><a href="../../roadmap/">Roadmap</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionPlay" href="#collapsePlay"><i class="icon-chevron-down"></i></a><a href="../../play/">Play ...</a>
            </div>
          <div id="collapsePlay" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../play/">BBC Newsreader</a>
                </li>
                <li>
                  <a href="../../play/panicbutton/">Rasberry Pi Panic Button</a>
                </li>
              </ul>
</div>
          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- /sidebar-module -->
<div class="page-footer">
  <div id="footer" class="container-fluid">
    <div class="row-fluid">
      <div class="footer_inner clearfix offset1">

        <ul class="footer_nav span2 unstyled">
<h4><a href="http://bluevia.com">Bluevia</a></h4>
          <li>
            <a href="https://bluevia.com/en/page/tour">Tour</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.TermsAndConds">terms and conditions</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.Privacy">privacy policy</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.Accessibility">accesibility</a>
          </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/tech">Tech Stuff</a></h4>
            <li>
                <a href="https://bluevia.com/en/page/tech.overview">Overview</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.howto">How To</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.APIs">APIs</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.libraries">Libraries</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.bluevialab">BlueVia Lab</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.arduino">Arduino</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/biz">Biz Stuff</a></h4>
            <li>
                <a href="https://bluevia.com/en/page/biz.businessmodels">Business Models</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.digitalgoods">Selling Digital Goods</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.getpaid">Get Paid</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.marketingstuff">Marketing Stuff</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.wayra">Wayra</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/inspiration">Inspiration</a></h4>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.appiversary">Appiversary</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.facejam">FaceJam</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.facetones">Facetones</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.textdeck">Textdeck</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration">More...</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4>Support</h4>
          <li>
            <a href="https://bluevia.com/en/page/support">contact us</a>
          </li>
        </ul>
</div>
    </div>
    <div class="row-fluid">

    </div>
    <!-- /.site --> </div>
  <!-- /#footer -->
</div>
<script>

  $(".apidoc li > dl > dt").addClass("span3");
  $(".apidoc dl dl dt").addClass("span4");
  $(".apimethod dt").addClass("span2");
  $(".apimethod dd").addClass("offset1");

  // Highlighting current page in the sidebar menu
  pathname = window.location.pathname;
  $("a[href='./']").parent().addClass("active");
  $("a[href='./']").parents(".collapse").collapse("show");

  pathtitle = $("#sidebar a[href='./']")[0];


  // Previous and next links
  menuLinks = $("#sidebar a").not(".accordion-toggle");
  pageIndex = $(menuLinks).index($(pathtitle));

  prevPageIndex = pageIndex-1;
  if ( $($(menuLinks)[prevPageIndex]).attr("href") == "./" )
    prevPageIndex = prevPageIndex - 1;
  prevPage = $($(menuLinks)[prevPageIndex]).clone();

  nextPageIndex = pageIndex+1;
  if ( $($(menuLinks)[nextPageIndex]).attr("href") == "./" )
    nextPageIndex = nextPageIndex + 1;
  nextPage = $($(menuLinks)[nextPageIndex]).clone();

  $(prevPage).prepend("<< ");
  $(nextPage).append(" >>");

  $("#prevPage").html($(prevPage));
  $("#nextPage").html($(nextPage));

  // Breadcrumbs
  parentGroup = $(pathtitle).parents(".accordion-group");
  parentCategoryText = $(".accordion-heading a:last",parentGroup)[0];
  if(parentCategoryText != null) {
    if($(parentCategoryText).text() != $(pathtitle).text())
      $(".breadcrumb li.active").before('<li><a href="'+$(parentCategoryText).attr("href")+'">'+$(parentCategoryText).text()+'</a> <span class="divider">/</span></li>');
  }
  if (pathtitle != null)
    $(".breadcrumb .active").text(pathtitle.text);

</script>
</body>
</html>
