<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="imagetoolbar" content="false">
<meta name="MSSmartTagsPreventParsing" content="true">
<title></title>
<link href="../../../css/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="../../../css/bluevia_style.css" rel="stylesheet" media="screen">
</head>
<body class="api" data-spy="scroll" data-target=".sidemenu">
  <script src="http://code.jquery.com/jquery-latest.js"></script><script src="../../../js/bootstrap.min.js"></script><div id="header-wrapper" class="page-header">
    <div id="header" class="container-fluid">
      <div class="row-fluid">
        <a class="logo offset1" href="../../../">
          <img src="http://bluevia.com/img/BlueVia-Hdr-Logo-SML.png" width="100" alt="Bluevia Logo"><span class="lightblue"></span>
        </a>

      </div>
    </div>
    <!-- #header --> </div>
  <!-- #header-wrapper -->

  <div class="container-fluid">
    <div class="row-fluid">
      <div class="content span8 offset1">

        <ul class="breadcrumb">
<li>
<a href="../../../">Home</a> <span class="divider">/</span>
</li>
          <li class="active">
        </ul>
<h1 id="getdigits">GetDigits</h1>

<p>The <em>getDigits</em> command allows for the collection of DTMF feedback from the callers handset.</p>

<p>Within the <em>getDigits</em> command, the following supporting elements can be provided:</p>

<ul>
<li>
    <p><em>actionUrl</em> - the URL that the <a href="../../notifications/">DigitsCollected notification event</a> is sent to.</p>
  </li>
  <li>
    <p><em>timeout</em> - positive integer value, default 5 seconds. If the caller doesn’t respond within this time period, a retry is attempted (if specified), or the command completes and you can fall through to a failure (no caller response) case.</p>
  </li>
  <li>
    <p><em>finishOnKey</em> - any digit, * or #, default #. The key, that if used by the caller will complete the dialpad input from the caller.</p>
  </li>
  <li>
    <p><em>numberOfDigits</em> - integer value, default of 0. This represents the number of digits to be collected, if set to 0 then there is no limit and the caller must complete DTMF entry via the finishOnKey value. If the caller enters this amount of digits on the dialpad, then the input is completed.</p>
  </li>
  <li>
    <p><em>validDigits</em> - any digit, * or #, default 1234567890*#, which specifies the valid digits that can be used by the caller when providing dialpad input.
a speak or play command is embeded within the getDigits command. This allows you to let the caller know what to do in order to submit dialpad input.
following a getDigits command you can specify either a speak or play command that is only used in the event that the caller doesn’t successfully get digits. E.g. if there was a timeout and all the retry attempts have been completed.</p>
  </li>
</ul>
<p><span style="color:#f00">Digits entered during the playback of Play/Speak content are ignored and playback does not stop. <a href="../../knownissues/">Known Issues</a></span></p>

<h2 id="json-examples">JSON Examples</h2>

<p>The following examples demonstrate how you can use the getDigits command</p>

<ul>
<li>
    <p>Using <em>getDigits</em> to retrieve a single digit from a caller</p>

    <pre><code>  {
  	"commands": [
  		{
    		"getDigits": {
    			"timeout": 5,
    			"numberOfDigits": 1,
    			"actionUrl": "http://your.domain.com/yourActionHandler",
    			"speak": {
    				"text": "Press 1 to create a new conference. Press 2 to join an existing conference call.",
    				"voice": "Female"
    			}
    		}
  		},
  		{
  			"speak": {
  				"text": "Sorry, you didn't enter a selection in time. Please call and try again.",
  				"voice": "Female"
  			}
  		},
  		{		
  		            "hangup": {
  				     }
          	}
  	]
  }
</code></pre>

    <ul>
<li>If the caller doesn’t enter any data within the 5 second timeout the speak command will be executed again</li>
      <li>
<em>NOTE</em>: If the caller enters valid input this second speak command will never be executed. The second speak command and the hangup command will only ever be executed if the getDigits command doesn’t result in a HTTP POST request to the actionUrl</li>
      <li>In the case of no input from the caller the call will be terminated via the <a href="../hangup/">hangup command</a>
</li>
      <li>In the event the caller enters a single digit, as specified by the numberOfDigits attribute, then a <a href="../../notifications/">DigitsCollected notification event</a> is sent, via a HTTP POST request to the specified actionUrl</li>
    </ul>
</li>
  <li>
    <p>Using getDigits to retrieve an unspecified number of characters for a callers dialpad, allowing the caller to terminate their input by selecting the ‘#’ key</p>

    <pre><code>  {
      "getDigits": {
          "finishOnKey": "#",
          "actionUrl": "http://your.domain.com/yourActionHandler",
          "speak": {
              "text": "Please enter some dialpad input. when you are finished press the hash key.",
              "voice": "Female"
          }
      }
  }
</code></pre>

    <ul>
<li>In this case the actionUrl will be called, with the dialpad keys the caller has pressed, only once the caller selects the ÔÇÿ#’ key. This data will be HTTP POSTed to the actionUrl in a <a href="../../notifications/">DigitsCollected notification event</a>.</li>
      <li>
<em>NOTE</em>: the “digits” attribute of the <a href="../../notifications/">DigitsCollected notification event</a> will also contain the ÔÇÿ#’ key that was submitted by the caller on the dialpad. If your business logic doesn’t require this finishOnKey remember to remove it prior to processing the caller’s input  </li>
      <li>
<em>NOTE</em>: In the above case the possible supporting commands are omitted for brevity.</li>
    </ul>
</li>
  <li>
    <p>Using getDigits to retrieve a filtered set of digits from a caller’s dialpad.</p>

    <pre><code>  {
      "getDigits": {
          "numberOfDigits" : 4,
          "validDigits" : "1357",
          "actionUrl": "http://your.domain.com/yourActionHandler",
          "speak": {
              "text": "Please enter 4 prime numbers.",
              "voice": "Female"
          }
      }
  }
</code></pre>

    <ul>
<li>In this case the actionUrl will be called, with the dialpad keys the caller has pressed, only once the caller has entered 4 prime numbers, i.e. those numbers specified in the filter validDigits attribute - 1357. This data will be HTTP POSTed to the actionUrl in a <a href="../../notifications/">DigitsCollected notification event</a>.</li>
      <li>
<em>NOTE</em>: In the above case the possible supporting commands are omitted for brevity.</li>
    </ul>
</li>
</ul>
<h2 id="xml-examples">XML Examples</h2>

<p>The same getDigits JSON commands can be described in XML as follows </p>

<ul>
<li>
    <p>Using getDigits to retrieve a single digit from a caller</p>

    <pre><code>  &lt;tns:modifyCall xsi:schemaLocation="http://api.bluevia.com/schemas/comms/v1 api.bluevia.com_comms_v1_0.xsd " xmlns:tns="http://api.bluevia.com/schemas/comms/v1" xmlns:tns1="http://api.bluevia.com/schemas/common/v2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
     &lt;tns:commands&gt;
        &lt;tns:getDigits&gt;
        	&lt;tns:timeout&gt;5&lt;/tns:timeout&gt;
        	&lt;tns:numberOfDigits&gt;1&lt;/tns:numberOfDigits&gt;
        	&lt;tns:actionUrl&gt;http://your.domain.com/yourActionHandler&lt;/tns:actionUrl&gt;
        	&lt;tns:speak&gt;
        		&lt;tns:text&gt;Press 1 to create a new conference. Press 2 to join an existing conference call.&lt;/tns:text&gt;
        		&lt;tns:voice&gt;Female&lt;/tns:voice&gt;
        	&lt;/tns:speak&gt;
        &lt;/tns:getDigits&gt;
        &lt;tns:speak&gt;
        	&lt;tns:text&gt;Sorry, you didn't enter a selection in time. Please call and try again.&lt;/tns:text&gt;
        	&lt;tns:voice&gt;Female&lt;/tns:voice&gt;      	
        &lt;/tns:speak&gt;
        &lt;tns:hangup/&gt;
     &lt;/tns:commands&gt;
  &lt;/tns:modifyCall&gt;
</code></pre>
  </li>
  <li>
    <p>Using getDigits to retrieve an unspecified number of characters for a callers dialpad, allowing the caller to terminate their input by selecting the ‘#’ key</p>

    <pre><code>  &lt;tns:modifyCall xsi:schemaLocation="http://api.bluevia.com/schemas/comms/v1 api.bluevia.com_comms_v1_0.xsd " xmlns:tns="http://api.bluevia.com/schemas/comms/v1" xmlns:tns1="http://api.bluevia.com/schemas/common/v2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
     &lt;tns:commands&gt;
        &lt;tns:getDigits&gt;
        	&lt;tns:finishOnKey&gt;#&lt;/tns:finishOnKey&gt;
        	&lt;tns:actionUrl&gt;http://your.domain.com/yourActionHandler&lt;/tns:actionUrl&gt;
        	&lt;tns:speak&gt;
        		&lt;tns:text&gt;Please enter some dialpad input. when you are finished press the hash key.&lt;/tns:text&gt;
        		&lt;tns:voice&gt;Female&lt;/tns:voice&gt;
        	&lt;/tns:speak&gt;
        &lt;/tns:getDigits&gt;     
     &lt;/tns:commands&gt;
  &lt;/tns:modifyCall&gt;
</code></pre>
  </li>
  <li>
    <p>Using getDigits to retrieve a filtered set of digits from a caller’s dialpad.</p>

    <pre><code>  &lt;tns:modifyCall xsi:schemaLocation="http://api.bluevia.com/schemas/comms/v1 api.bluevia.com_comms_v1_0.xsd " xmlns:tns="http://api.bluevia.com/schemas/comms/v1" xmlns:tns1="http://api.bluevia.com/schemas/common/v2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
     &lt;tns:commands&gt;
        &lt;tns:getDigits&gt;
        	&lt;tns:numberOfDigits&gt;4&lt;/tns:numberOfDigits&gt;
        	&lt;tns:validDigits&gt;1357&lt;/tns:validDigits&gt;
        	&lt;tns:actionUrl&gt;http://your.domain.com/yourActionHandler&lt;/tns:actionUrl&gt;
        	&lt;tns:speak&gt;
        		&lt;tns:text&gt;Please enter 4 prime numbers.&lt;/tns:text&gt;
        		&lt;tns:voice&gt;Female&lt;/tns:voice&gt;
        	&lt;/tns:speak&gt;
        &lt;/tns:getDigits&gt;     
     &lt;/tns:commands&gt;
  &lt;/tns:modifyCall&gt;
</code></pre>
  </li>
</ul>
<!-- Bluevia  --><!-- Overview --><!-- Quick start --><!-- Restref --><!-- Command ref --><!-- Notifications --><!-- Error codes  --><!-- Roadmap --><!-- Play --><!-- Known Issues --><hr>
<span id="prevPage" class="bottomLinks pull-left"></span>
        <span id="nextPage" class="bottomLinks pull-right"></span>

      </div>

      <div id="sidebar" class="span3">
        <div class="accordion" id="accordionMenu">
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionOverview" href="#collapseOverview"><i class="icon-chevron-down"></i></a><a href="../../overview/">Overview</a>
            </div>
          <div id="collapseOverview" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="js-guides nav nav-list sidemenu">
<li>
                  <a href="../../overview/restapi/">BlueVia Voice RESTful API</a>
                </li>
                <li>
                  <a href="../../overview/callcontrol/">BlueVia Voice Call Control Commands</a>
                </li>
                <li>
                  <a href="../../overview/callflows/">Call Flows</a>
                </li>
                <li>
                  <a href="../../overview/existing/">Existing BlueVia APIs and the BlueVia Voice API</a>
                </li>
                <li>
                  <a href="../../overview/balance/">Adding Balance To Your BlueVia Account</a>
                </li>
                <li>
                  <a href="../../overview/numbers/">Buying Numbers</a>
                </li>
                <li>
                  <a href="../../overview/configure/">Configuring Your BlueVia Numbers</a>
                </li>
                <li>
                  <a href="../../overview/usingnumbers/">Using Your BlueVia Voice Numbers</a>
                </li>
                <li>
                  <a href="../../overview/pricing/">BlueVia Voice API Costs</a>
                </li>
                <li>
                  <a href="../../overview/knownlimitations/">Known Alpha Limitations</a>
                </li>
              </ul>
</div>
          </div>

          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionQuickstart" href="#collapseQuickstart"><i class="icon-chevron-down"></i></a><a href="../../quickstart/">Quick Start Guides</a>
            </div>
          <div id="collapseQuickstart" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../quickstart/connectcallnocode/">Connect a Call Without Code</a>
                </li>
                <li>
                  <a href="../../quickstart/createconfnocode/">Create a Conference Without Code</a>
                </li>
                <li>
                  <a href="../../quickstart/confwithpincode/">A Conference With Pin Code</a>
                </li>
                <li>
                  <a href="../../quickstart/restapicreatecall/">Create A Call With the REST API</a>
                </li>
                <li>
                  <a href="../../quickstart/modifycall/">Modify An Existing Call</a>
                </li>
                <li>
                  <a href="../../quickstart/restapicreateconf/">Create A Conference Call With The REST API</a>
                </li>
                <li>
                  <a href="../../quickstart/restapiupdateconfig/">Update Your Number's Config With The REST API</a>
                </li>

              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionRestRef" href="#collapseRestRef"><i class="icon-chevron-down"></i></a><a href="../../restref/">RESTful API Reference</a>
            </div>
          <div id="collapseRestRef" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../restref/request/">HTTP Request</a>
                </li>

                <li>
                  <a href="../../restref/resources/">Resources</a>
                  </li>
<li>
                    <ul class="nav nav-list">
<li>
                        <a href="../../restref/accountresources/">Account Management Resources</a>
                      </li>
                      <li>
                        <ul class="nav nav-list">
<li>
                            <a href="../../restref/account/">Account</a>
                          </li>
                          <li>
                            <a href="../../restref/accountnumber/">Account Number</a>
                          </li>
                          <li>
                            <a href="../../restref/accountconfigrulescollection/">Account Config Rules Collection</a>
                          </li>
                        </ul>
</li>
                      <li>
                        <a href="../../restref/availablenumberscollection/">Available Numbers Collection</a>
                      </li>
                      <li>
                        <a href="../../restref/calls/">Calls Resources</a>
                      </li>
                      <li>
                          <ul class="nav nav-list">
<li>
                              <a href="../../restref/callcollection/">Call Collection</a>
                            </li>
                            <li>
                              <a href="../../restref/call/">Call</a>
                            </li>
                            <li>
                              <a href="../../restref/calllegscollection/">Calls Leg Collection</a>
                            </li>
                            <li>
                              <a href="../../restref/callleg/">Call Leg</a>
                            </li>
                            <li>
                              <a href="../../restref/modifycall/">Modify Call - Set Commands</a>
                            </li>
                          </ul>
</li>
                      <li>
                        <a href="../../restref/sms/">SMS Resources</a>
                      </li>
                    </ul>
</li>
                

                <li>
                  <a href="../../restref/callstatuses/">Call Statuses</a>
                </li>
                <li>
                  <a href="../../restref/calllegstatuses/">Call Leg Statuses</a>
                </li>
              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionCommandRef" href="#collapseCommandRef"><i class="icon-chevron-down"></i></a><a href="../">Call Control Commands Reference</a>
            </div>
          <div id="collapseCommandRef" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../sendingcallcommands/">Providing Call Commands</a>
                </li>
                <li>
                  <a href="../dial/">Dial</a>
                </li>
                <li>
                  <ul class="nav nav-list">
<li>
                      <a href="../dialnumber/">Dial Number</a>
                    </li>
                    <li>
                      <a href="../dialconference/">Dial Conference</a>
                    </li>
                    <li>
                      <a href="../dialcallid/">Dial Call Id</a>
                    </li>
                  </ul>
</li>
                <li>
                  <a href="../speak/">Speak</a>
                </li>
                <li>
                  <a href="../play/">Play</a>
                </li>
                <li>
                  <a href="./">GetDigits</a>
                </li>
                <li>
                  <a href="../hangup/">HangUp</a>
                </li>
                <li>
                  <a href="../redirect/">Redirect</a>
                </li>
                <li>
                  <a href="../wait/">Wait</a>
                </li>
                <li>
                  <a href="../sms/">SMS</a>
                </li>
                <li>
                  <a href="../commandchains/">Command Chains</a>
                </li>
              </ul>
</div>
          </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionNotifications" href="#collapseNotifications"><i class="icon-chevron-down"></i></a><a href="../../notifications/">Notification Events Reference</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionErrorCodes" href="#collapseErrorCodes"><i class="icon-chevron-down"></i></a><a href="../../errorcodes/">Voice and SMS Error Codes</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionRoadmap" href="#collapseRoadmap"><i class="icon-chevron-down"></i></a><a href="../../roadmap/">Roadmap</a>
            </div>
          </div>
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle inline" data-toggle="collapse" data-parent="#accordionPlay" href="#collapsePlay"><i class="icon-chevron-down"></i></a><a href="../../play/">Play ...</a>
            </div>
          <div id="collapsePlay" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="nav nav-list">
<li>
                  <a href="../../play/">BBC Newsreader</a>
                </li>
                <li>
                  <a href="../../play/panicbutton/">Rasberry Pi Panic Button</a>
                </li>
              </ul>
</div>
          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- /sidebar-module -->
<div class="page-footer">
  <div id="footer" class="container-fluid">
    <div class="row-fluid">
      <div class="footer_inner clearfix offset1">

        <ul class="footer_nav span2 unstyled">
<h4><a href="http://bluevia.com">Bluevia</a></h4>
          <li>
            <a href="https://bluevia.com/en/page/tour">Tour</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.TermsAndConds">terms and conditions</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.Privacy">privacy policy</a>
          </li>
          <li>
            <a href="http://bluevia.com/ot-www/webroot/index.php/en/page/boilerplate.Accessibility">accesibility</a>
          </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/tech">Tech Stuff</a></h4>
            <li>
                <a href="https://bluevia.com/en/page/tech.overview">Overview</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.howto">How To</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.APIs">APIs</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.libraries">Libraries</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.bluevialab">BlueVia Lab</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/tech.arduino">Arduino</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/biz">Biz Stuff</a></h4>
            <li>
                <a href="https://bluevia.com/en/page/biz.businessmodels">Business Models</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.digitalgoods">Selling Digital Goods</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.getpaid">Get Paid</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.marketingstuff">Marketing Stuff</a>
            </li>
            <li>
                <a href="https://bluevia.com/en/page/biz.wayra">Wayra</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4><a href="https://bluevia.com/en/page/inspiration">Inspiration</a></h4>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.appiversary">Appiversary</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.facejam">FaceJam</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.facetones">Facetones</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration.textdeck">Textdeck</a>
            </li>
            <li>
                <a id="menu-case" href="https://bluevia.com/en/page/inspiration">More...</a>
            </li>
        </ul>
<ul class="footer_nav span2 unstyled">
<h4>Support</h4>
          <li>
            <a href="https://bluevia.com/en/page/support">contact us</a>
          </li>
        </ul>
</div>
    </div>
    <div class="row-fluid">

    </div>
    <!-- /.site --> </div>
  <!-- /#footer -->
</div>
<script>

  $(".apidoc li > dl > dt").addClass("span3");
  $(".apidoc dl dl dt").addClass("span4");
  $(".apimethod dt").addClass("span2");
  $(".apimethod dd").addClass("offset1");

  // Highlighting current page in the sidebar menu
  pathname = window.location.pathname;
  $("a[href='./']").parent().addClass("active");
  $("a[href='./']").parents(".collapse").collapse("show");

  pathtitle = $("#sidebar a[href='./']")[0];


  // Previous and next links
  menuLinks = $("#sidebar a").not(".accordion-toggle");
  pageIndex = $(menuLinks).index($(pathtitle));

  prevPageIndex = pageIndex-1;
  if ( $($(menuLinks)[prevPageIndex]).attr("href") == "./" )
    prevPageIndex = prevPageIndex - 1;
  prevPage = $($(menuLinks)[prevPageIndex]).clone();

  nextPageIndex = pageIndex+1;
  if ( $($(menuLinks)[nextPageIndex]).attr("href") == "./" )
    nextPageIndex = nextPageIndex + 1;
  nextPage = $($(menuLinks)[nextPageIndex]).clone();

  $(prevPage).prepend("<< ");
  $(nextPage).append(" >>");

  $("#prevPage").html($(prevPage));
  $("#nextPage").html($(nextPage));

  // Breadcrumbs
  parentGroup = $(pathtitle).parents(".accordion-group");
  parentCategoryText = $(".accordion-heading a:last",parentGroup)[0];
  if(parentCategoryText != null) {
    if($(parentCategoryText).text() != $(pathtitle).text())
      $(".breadcrumb li.active").before('<li><a href="'+$(parentCategoryText).attr("href")+'">'+$(parentCategoryText).text()+'</a> <span class="divider">/</span></li>');
  }
  if (pathtitle != null)
    $(".breadcrumb .active").text(pathtitle.text);

</script>
</body>
</html>
